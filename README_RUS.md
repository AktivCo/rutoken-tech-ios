[Английский/English](README.md) 

# Описание
Рутокен Технологии — приложение для демонстрации возможностей устройств линейки Рутокен ЭЦП на мобильных устройствах с iOS или iPadOS версий 16.2 и новее.
Приложение содержит два раздела:
* Удостоверяющий центр  — для демонстрации возможностей тестового удостоверяющего центра. В этом разделе можно: сгенерировать ключевую пару и выпустить тестовый сертификат на мобильном устройстве. Созданные объекты можно использовать в разделе Банк.
* Банк — для демонстрации сценариев работы с устройствами Рутокен в банковских приложениях. В этом разделе можно: подписать тестовый платежный документ, проверить действительность электронной подписи входящих документов, зашифровать и расшифровать банковский документ.

# Требования
Приложение собирается с iOS SDK 16.2 и новее и запускается на устройствах c iOS/iPadOS начиная с 16.2.
Внешние зависимости находятся в [Рутокен SDK](http://www.rutoken.ru/developers/sdk/)

Необходимые файлы и фреймворки:
•  openssl/bin/3.0/openssl-3.0/openssl-tool-3.0/macos-x86_64+arm64/*
•  openssl/bin/3.0/rtengine-3.0/ios+iossim+macos-x86_64+arm64-xcframework/rtengine.xcframework

 **Внимание, это инструкция по настройке приложения Рутокен Технологии. Подробнее о возможностях и встраивании токенов в ваши приложения читайте в [особенностях встраивания NFC-устройств семейства Рутокен ЭЦП в собственные приложения](https://dev.rutoken.ru/pages/viewpage.action?pageId=81527019)**.

# Предварительные действия
Для работы в разделе Банк, на устройстве линейки Рутокен ЭЦП необходимо иметь ключевую пару и сертификат. Если их нет, то для тестовых целей создать их можно в разделе Удостоверяющий центр мобильного приложения.
Или на настольном компьютере выполнить следующие действия:
1.  Загрузите и установите [Рутокен Плагин]([https://www.rutoken.ru/products/all/rutoken-plugin/](https://www.rutoken.ru/products/all/rutoken-plugin/)) на компьютер.
2.  Перезагрузите браузер для завершения установки плагина.
3.  Через браузер зайдите на веб-сайт [Центр регистрации Рутокен]([https://ra.rutoken.ru/](https://ra.rutoken.ru/)).
4.  Подключите устройство линейки Рутокен ЭЦП к компьютеру.
5.  Убедитесь, что веб-сайт обнаружил устройство.
6.  Создайте ключевую пару и сертификат, следуя инструкциям на веб-сайте.
7.  Убедитесь, что веб-сайт обнаружил ключевую пару и сертификат на устройстве.
8.  Отключите устройство Рутокен от компьютера и используйте его вместе с iPhone или iPad.

# Генерация ключей и сертификатов для работы с Rutoken Tech
Для работы в разделах Банк и Удостоверяющий центр в директории `Rutoken Tech/Credentials` должны быть сохранены собственные файлы ключей и сертификатов. В репозитории уже есть предварительно сгенерированные файлы, но вы можете создать свои по инструкции ниже:
1.  Положите rtengine.xcframework в директорию `prepareCredentials` в корне проекта;
2.  Положите директорию с бинарными файлами OpenSSL (`macos-x86_64+arm64`) в директорию `prepareCredentials` в корне проекта;
3.  Укажите путь до бинарного файла rtengine в файл openssl.cnf, расположенный в директории `prepareCredentials`:
```
openssl_conf = openssl_def

[ openssl_def ]
    engines = engine_section

[ engine_section ]
    rtengine = gost_section

[ gost_section ]
    dynamic_path = /path/to/rtengine.xcframework/macos-arm64_x86_64/rtengine.framework/rtengine
```
4.  Запустите скрипт `generateCredentials.sh`.

# Ограничения
Приложение может быть запущено только на физических устройствах Apple, не на эмуляторе.

# Лицензия
Программный код проекта распространяется по [Simplified BSD License](LICENSE_RUS), директория rutoken-tech-ios содержит объекты авторского права и распространяется по [коммерческой лицензии АО «Актив-Софт»](https://download.rutoken.ru/License_Agreement.pdf).
